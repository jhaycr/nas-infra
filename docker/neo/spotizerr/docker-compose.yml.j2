---
services:

  spotizerr:
    container_name: spotizerr
    image: cooldockerizer93/spotizerr
    volumes:
      - {{ docker_appdata_path }}/spotizerr/creds:/app/creds
      - {{ docker_appdata_path }}/spotizerr/config:/app/config
      - {{ docker_appdata_path }}/spotizerr/logs:/app/logs  # <-- Volume for persistent logs
      - {{ nas_storage_path }}/media/audio/music/General:/app/downloads # <-- Change this for your music library dir
    ports:
      - 7171:7171
    restart: unless-stopped
    environment:
      - PUID=1000  # Replace with your desired user ID  | Remove both if you want to run as root (not recommended, might result in unreadable files)
      - PGID=1000  # Replace with your desired group ID | The user must have write permissions in the volume mapped to /app/downloads
      - UMASK=0022 # Optional: Sets the default file permissions for newly created files within the container.
      - REDIS_HOST=spotizerr-redis
      - REDIS_PORT=6379
      - REDIS_DB=0
      - REDIS_URL=redis://spotizerr-redis:6379/0
      - REDIS_BACKEND=redis://spotizerr-redis:6379/0
      - EXPLICIT_FILTER=false # Set to true to filter out explicit content
    depends_on:
      - spotizerr-redis

  spotizerr-redis:
    image: redis:alpine
    container_name: spotizerr-redis
    restart: unless-stopped
    volumes:
      - spotizerr-redis-data:/data
    command: redis-server --appendonly yes
    
volumes:
  spotizerr-redis-data:
    driver: local